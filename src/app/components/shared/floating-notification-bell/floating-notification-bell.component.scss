// =============================================================================
// VARIABLES DE COLORES DE INTRANET
// =============================================================================

// Colores por prioridad usando variables de intranet
$priority-urgent: #dc2626; // Rojo urgente
$priority-high: var(--intranet-accent-color-yellow, #ffcc0c); // Amarillo importante
$priority-medium: var(--intranet-accent-color-blue, #253470); // Azul normal
$priority-low: var(--intranet-accent-color-green, #77a02d); // Verde info

// =============================================================================
// ANIMACIONES
// =============================================================================

@keyframes bell-ring {
	0% {
		transform: rotate(0);
	}
	10% {
		transform: rotate(15deg);
	}
	20% {
		transform: rotate(-15deg);
	}
	30% {
		transform: rotate(10deg);
	}
	40% {
		transform: rotate(-10deg);
	}
	50% {
		transform: rotate(5deg);
	}
	60% {
		transform: rotate(-5deg);
	}
	70% {
		transform: rotate(2deg);
	}
	80% {
		transform: rotate(-2deg);
	}
	90%,
	100% {
		transform: rotate(0);
	}
}

@keyframes pulse {
	0%,
	100% {
		transform: scale(1);
		opacity: 1;
	}
	50% {
		transform: scale(1.15);
		opacity: 0.8;
	}
}

@keyframes pulse-ring {
	0% {
		transform: scale(1);
		opacity: 0.8;
	}
	100% {
		transform: scale(1.8);
		opacity: 0;
	}
}

@keyframes shake {
	0%,
	100% {
		transform: translateX(0);
	}
	10%,
	30%,
	50%,
	70%,
	90% {
		transform: translateX(-4px);
	}
	20%,
	40%,
	60%,
	80% {
		transform: translateX(4px);
	}
}

@keyframes slideInRight {
	from {
		opacity: 0;
		transform: translateX(30px);
	}
	to {
		opacity: 1;
		transform: translateX(0);
	}
}

@keyframes slideInDown {
	from {
		opacity: 0;
		transform: translateY(-20px);
	}
	to {
		opacity: 1;
		transform: translateY(0);
	}
}

@keyframes glow-urgent {
	0%,
	100% {
		box-shadow:
			0 0 5px rgba(220, 38, 38, 0.5),
			0 0 10px rgba(220, 38, 38, 0.3);
	}
	50% {
		box-shadow:
			0 0 15px rgba(220, 38, 38, 0.8),
			0 0 25px rgba(220, 38, 38, 0.5);
	}
}

@keyframes glow-high {
	0%,
	100% {
		box-shadow:
			0 0 5px rgba(255, 204, 12, 0.5),
			0 0 10px rgba(255, 204, 12, 0.3);
	}
	50% {
		box-shadow:
			0 0 15px rgba(255, 204, 12, 0.8),
			0 0 25px rgba(255, 204, 12, 0.5);
	}
}

// =============================================================================
// OVERLAY PARA CERRAR EL PANEL
// =============================================================================

.notifications-overlay {
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background: rgba(0, 0, 0, 0.3);
	z-index: 998;
	backdrop-filter: blur(2px);
}

// =============================================================================
// CAMPANA FLOTANTE
// =============================================================================

.notification-bell-container {
	position: fixed;
	top: 100px;
	right: 24px;
	z-index: 1000;

	&.has-unread {
		.notification-bell {
			&::before {
				content: '';
				position: absolute;
				inset: -4px;
				border-radius: 50%;
				background: rgba(220, 38, 38, 0.3);
				animation: pulse-ring 1.5s ease-out infinite;
			}

			// Colores por prioridad
			&.badge-urgent::before {
				background: rgba(220, 38, 38, 0.3);
			}

			&.badge-high::before {
				background: rgba(255, 204, 12, 0.3);
			}

			&.badge-medium::before {
				background: rgba(37, 52, 112, 0.3);
			}

			&.badge-low::before {
				background: rgba(119, 160, 45, 0.3);
			}
		}
	}
}

.notification-bell {
	position: relative;
	width: 60px;
	height: 60px;
	border-radius: 50%;
	// Campana siempre amarilla por defecto
	background: linear-gradient(135deg, var(--intranet-accent-color-yellow, #ffcc0c), #e6b800);
	border: none;
	cursor: pointer;
	display: flex;
	align-items: center;
	justify-content: center;
	box-shadow:
		0 6px 20px rgba(255, 204, 12, 0.4),
		0 2px 8px rgba(0, 0, 0, 0.1);
	transition: all 0.3s ease;

	// Solo cambia a rojo si es urgente
	&.badge-urgent {
		background: linear-gradient(135deg, $priority-urgent, #b91c1c);
		box-shadow:
			0 6px 20px rgba(220, 38, 38, 0.4),
			0 2px 8px rgba(0, 0, 0, 0.1);
	}

	// El resto mantiene amarillo
	&.badge-high,
	&.badge-medium,
	&.badge-low {
		background: linear-gradient(135deg, var(--intranet-accent-color-yellow, #ffcc0c), #e6b800);
	}

	i {
		font-size: 1.6rem;
		color: var(--intranet-default-text-color, #171717);
		transition: transform 0.3s;
	}

	&.badge-urgent i {
		color: white;
	}

	&:hover {
		transform: scale(1.1);
		box-shadow: 0 8px 25px rgba(255, 204, 12, 0.5);

		i {
			animation: bell-ring 0.8s ease;
		}
	}

	&.badge-urgent:hover {
		box-shadow: 0 8px 25px rgba(220, 38, 38, 0.5);
	}

	&.ringing {
		i {
			animation: bell-ring 1s ease infinite;
		}
	}

	// Cuando no hay notificaciones sin leer, aplicar escala de grises
	&:not(.ringing) {
		filter: grayscale(70%);
		opacity: 0.7;
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);

		&:hover {
			filter: grayscale(30%);
			opacity: 0.9;
			box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15);
		}
	}
}

.bell-badge {
	position: absolute;
	top: -4px;
	right: -4px;
	min-width: 22px;
	height: 22px;
	padding: 0 6px;
	border-radius: 11px;
	color: white;
	font-size: 0.75rem;
	font-weight: 700;
	display: flex;
	align-items: center;
	justify-content: center;
	border: 2px solid white;

	// Colores por prioridad
	&.badge-urgent {
		background: linear-gradient(135deg, $priority-urgent, #b91c1c);
		box-shadow: 0 2px 8px rgba(220, 38, 38, 0.5);
	}

	&.badge-high {
		background: linear-gradient(135deg, #ffcc0c, #d4a700);
		color: var(--intranet-default-text-color, #171717);
		box-shadow: 0 2px 8px rgba(255, 204, 12, 0.5);
	}

	&.badge-medium {
		background: linear-gradient(135deg, var(--intranet-accent-color-blue, #253470), #1a2550);
		box-shadow: 0 2px 8px rgba(37, 52, 112, 0.5);
	}

	&.badge-low {
		background: linear-gradient(135deg, var(--intranet-accent-color-green, #77a02d), #5c7d22);
		box-shadow: 0 2px 8px rgba(119, 160, 45, 0.5);
	}

	&.pulse {
		animation: pulse 1.5s ease-in-out infinite;
	}
}

// =============================================================================
// NOTIFICACIONES SECTION
// =============================================================================

.notifications-section {
	position: fixed;
	top: 80px;
	right: 24px;
	width: 480px;
	max-width: calc(100vw - 48px);
	max-height: calc(100vh - 120px);
	overflow-y: auto;
	margin-bottom: 2rem;
	animation: slideInDown 0.3s ease-out;
	background: var(--intranet-white-color, #ffffffee);
	border-radius: 24px;
	padding: 1.75rem;
	border: 2px solid var(--intranet-accent-color-yellow, #ffcc0c);
	box-shadow: 0 12px 40px rgba(0, 0, 0, 0.18);
	z-index: 999;
	backdrop-filter: blur(12px);
}

.notifications-header {
	display: flex;
	justify-content: space-between;
	align-items: flex-start;
	margin-bottom: 1.75rem;
	padding-bottom: 1.25rem;
	border-bottom: 2px solid var(--intranet-accent-color-yellow, #ffcc0c);

	.header-left {
		display: flex;
		align-items: flex-start;
		gap: 1rem;
	}

	.header-text {
		h2 {
			margin: 0;
			font-size: 1.35rem;
			color: var(--intranet-default-text-color, #171717);
			font-weight: var(--intranet-font-weight-bold, bold);
		}
	}

	.notification-subtitle {
		font-size: 0.85rem;
		color: var(--intranet-soft-text-color, #5e5e5e);
	}

	.unread-indicator {
		font-weight: 600;

		&.badge-urgent {
			color: $priority-urgent;
		}

		&.badge-high {
			color: #d4a700;
		}

		&.badge-medium {
			color: var(--intranet-accent-color-blue, #253470);
		}

		&.badge-low {
			color: var(--intranet-accent-color-green, #77a02d);
		}
	}

	.header-actions {
		display: flex;
		gap: 0.75rem;
	}
}

// =============================================================================
// RESUMEN DE PRIORIDADES
// =============================================================================

.priority-summary {
	display: flex;
	flex-wrap: wrap;
	gap: 0.6rem;
	margin-top: 0.75rem;
}

.priority-badge {
	font-size: 0.7rem;
	padding: 0.3rem 0.6rem;
	border-radius: 6px;
	font-weight: 600;
	text-transform: uppercase;
	letter-spacing: 0.5px;

	&.priority-urgent {
		background: rgba(220, 38, 38, 0.15);
		color: $priority-urgent;
	}

	&.priority-high {
		background: rgba(255, 204, 12, 0.2);
		color: #b8960a;
	}

	&.priority-medium {
		background: rgba(37, 52, 112, 0.15);
		color: var(--intranet-accent-color-blue, #253470);
	}

	&.priority-low {
		background: rgba(119, 160, 45, 0.15);
		color: var(--intranet-accent-color-green, #77a02d);
	}
}

.bell-icon-animated {
	width: 54px;
	height: 54px;
	border-radius: 16px;
	// Siempre amarillo por defecto
	background: linear-gradient(135deg, var(--intranet-accent-color-yellow, #ffcc0c), #e6b800);
	display: flex;
	align-items: center;
	justify-content: center;
	box-shadow: 0 6px 16px rgba(255, 204, 12, 0.4);

	// Solo rojo si es urgente
	&.badge-urgent {
		background: linear-gradient(135deg, $priority-urgent, #b91c1c);
		box-shadow: 0 6px 16px rgba(220, 38, 38, 0.4);

		i {
			color: white;
		}
	}

	// El resto mantiene amarillo
	&.badge-high,
	&.badge-medium,
	&.badge-low {
		background: linear-gradient(135deg, var(--intranet-accent-color-yellow, #ffcc0c), #e6b800);
		box-shadow: 0 6px 16px rgba(255, 204, 12, 0.4);
	}

	i {
		font-size: 1.6rem;
		color: var(--intranet-default-text-color, #171717);
	}

	&.ringing {
		animation: shake 0.5s ease-in-out;
		animation-iteration-count: 3;

		i {
			animation: bell-ring 0.8s ease infinite;
		}
	}
}

.action-btn {
	display: flex;
	align-items: center;
	gap: 0.5rem;
	padding: 0.6rem 1rem;
	border-radius: 10px;
	font-size: 0.85rem;
	font-weight: 500;
	cursor: pointer;
	transition: all 0.2s ease;
	border: none;

	i {
		font-size: 1rem;
	}

	.btn-text {
		display: inline;
	}
}

.mark-read-btn {
	background: rgba(119, 160, 45, 0.1);
	color: var(--intranet-accent-color-green, #77a02d);

	&:hover {
		background: var(--intranet-accent-color-green, #77a02d);
		color: white;
		transform: translateY(-2px);
		box-shadow: 0 4px 12px rgba(119, 160, 45, 0.3);
	}
}

.dismiss-all-btn {
	background: rgba(220, 38, 38, 0.1);
	color: $priority-urgent;

	&:hover {
		background: $priority-urgent;
		color: white;
		transform: translateY(-2px);
		box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);
	}
}

// =============================================================================
// LISTA DE NOTIFICACIONES
// =============================================================================

.notifications-list {
	display: flex;
	flex-direction: column;
	gap: 1.25rem;
}

.notification-card {
	display: flex;
	gap: 1.25rem;
	padding: 1.5rem;
	background: white;
	border-radius: 18px;
	border-left: 5px solid var(--intranet-accent-color-blue, #253470);
	box-shadow: 0 3px 12px rgba(0, 0, 0, 0.06);
	position: relative;
	cursor: pointer;
	animation: slideInRight 0.4s ease-out backwards;
	transition: all 0.3s ease;

	&:hover {
		transform: translateX(8px);
		box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
	}

	// Estado leído
	&.is-read {
		opacity: 0.7;
		background: var(--intranet-background-color, #f5f5f5);

		.notification-title {
			font-weight: 500;
		}
	}

	// Estado no leído
	&.is-unread {
		background: white;
		box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);

		.notification-title {
			font-weight: 700;
		}
	}

	// Prioridades con estilos mejorados usando colores de intranet
	&.notification-urgent {
		border-left-color: $priority-urgent;
		background: linear-gradient(to right, rgba(220, 38, 38, 0.08), white);

		&.is-unread {
			animation:
				slideInRight 0.4s ease-out backwards,
				shake 0.5s ease-in-out 0.5s,
				glow-urgent 2s ease-in-out infinite;
		}

		.notification-icon {
			background: linear-gradient(135deg, $priority-urgent, #b91c1c);
			color: white;
			box-shadow: 0 4px 15px rgba(220, 38, 38, 0.4);
		}
	}

	&.notification-high {
		border-left-color: #ffcc0c;
		background: linear-gradient(to right, rgba(255, 204, 12, 0.08), white);

		.notification-icon {
			background: linear-gradient(135deg, #ffcc0c, #d4a700);
			color: var(--intranet-default-text-color, #171717);
			box-shadow: 0 4px 15px rgba(255, 204, 12, 0.4);
		}
	}

	&.notification-medium {
		border-left-color: var(--intranet-accent-color-blue, #253470);

		.notification-icon {
			background: linear-gradient(
				135deg,
				var(--intranet-accent-color-blue, #253470),
				#1a2550
			);
			color: white;
			box-shadow: 0 4px 15px rgba(37, 52, 112, 0.3);
		}
	}

	&.notification-low {
		border-left-color: var(--intranet-accent-color-green, #77a02d);

		.notification-icon {
			background: linear-gradient(
				135deg,
				var(--intranet-accent-color-green, #77a02d),
				#5c7d22
			);
			color: white;
			box-shadow: 0 4px 15px rgba(119, 160, 45, 0.3);
		}
	}
}

// Punto de no leído con colores por prioridad
.unread-dot {
	position: absolute;
	top: 1rem;
	left: -2.5px;
	width: 10px;
	height: 10px;
	border-radius: 50%;
	background: $priority-urgent;
	box-shadow: 0 0 8px rgba(220, 38, 38, 0.6);

	&.notification-urgent {
		background: $priority-urgent;
		box-shadow: 0 0 8px rgba(220, 38, 38, 0.6);
	}

	&.notification-high {
		background: #ffcc0c;
		box-shadow: 0 0 8px rgba(255, 204, 12, 0.6);
	}

	&.notification-medium {
		background: var(--intranet-accent-color-blue, #253470);
		box-shadow: 0 0 8px rgba(37, 52, 112, 0.6);
	}

	&.notification-low {
		background: var(--intranet-accent-color-green, #77a02d);
		box-shadow: 0 0 8px rgba(119, 160, 45, 0.6);
	}

	&.pulse {
		animation: pulse 1.5s ease-in-out infinite;
	}
}

.notification-icon {
	display: flex;
	align-items: center;
	justify-content: center;
	width: 52px;
	height: 52px;
	border-radius: 14px;
	flex-shrink: 0;
	transition: transform 0.3s ease;

	i {
		font-size: 1.35rem;
	}

	.notification-card:hover & {
		transform: scale(1.1) rotate(-5deg);
	}

	// Colores por tipo
	&.icon-matricula {
		background: linear-gradient(
			135deg,
			var(--intranet-accent-color-blue, #253470),
			#1a2550
		) !important;
		color: white !important;
	}

	&.icon-pago {
		background: linear-gradient(
			135deg,
			var(--intranet-accent-color-green, #77a02d),
			#5c7d22
		) !important;
		color: white !important;
	}

	&.icon-academico {
		background: linear-gradient(135deg, #a855f7, #9333ea) !important;
		color: white !important;
	}

	&.icon-festividad {
		background: linear-gradient(
			135deg,
			var(--intranet-accent-color-yellow, #ffcc0c),
			#d4a700
		) !important;
		color: var(--intranet-default-text-color, #171717) !important;
	}

	&.icon-evento {
		background: linear-gradient(135deg, #f97316, #ea580c) !important;
		color: white !important;
	}
}

.notification-content {
	flex: 1;
	min-width: 0;
}

.notification-meta {
	display: flex;
	align-items: center;
	gap: 0.85rem;
	margin-bottom: 0.75rem;
}

.notification-type-badge {
	display: inline-flex;
	align-items: center;
	font-size: 0.7rem;
	text-transform: uppercase;
	font-weight: 700;
	padding: 0.25rem 0.6rem;
	border-radius: 6px;
	letter-spacing: 0.5px;

	&[data-type='matricula'] {
		background: rgba(37, 52, 112, 0.15);
		color: var(--intranet-accent-color-blue, #253470);
	}

	&[data-type='pago'] {
		background: rgba(119, 160, 45, 0.15);
		color: var(--intranet-accent-color-green, #77a02d);
	}

	&[data-type='academico'] {
		background: rgba(168, 85, 247, 0.15);
		color: #a855f7;
	}

	&[data-type='festividad'] {
		background: rgba(255, 204, 12, 0.2);
		color: #b8960a;
	}

	&[data-type='evento'] {
		background: rgba(249, 115, 22, 0.15);
		color: #f97316;
	}
}

.priority-indicator {
	font-size: 0.65rem;
	text-transform: uppercase;
	font-weight: 600;
	padding: 0.2rem 0.5rem;
	border-radius: 4px;
	letter-spacing: 0.5px;

	&[data-priority='urgent'] {
		background: rgba(220, 38, 38, 0.15);
		color: $priority-urgent;
		animation: pulse 1.5s ease-in-out infinite;
	}

	&[data-priority='high'] {
		background: rgba(255, 204, 12, 0.2);
		color: #b8960a;
	}

	&[data-priority='medium'] {
		background: rgba(37, 52, 112, 0.15);
		color: var(--intranet-accent-color-blue, #253470);
	}

	&[data-priority='low'] {
		background: rgba(119, 160, 45, 0.15);
		color: var(--intranet-accent-color-green, #77a02d);
	}
}

.notification-title {
	margin: 0 0 0.5rem;
	font-size: 1.1rem;
	color: var(--intranet-default-text-color, #171717);
	line-height: 1.35;
}

.notification-message {
	margin: 0 0 1rem;
	color: var(--intranet-soft-text-color, #5e5e5e);
	font-size: 0.95rem;
	line-height: 1.55;
}

.notification-action {
	display: inline-flex;
	align-items: center;
	gap: 0.5rem;
	color: var(--intranet-accent-color-blue, #253470);
	font-size: 0.9rem;
	font-weight: 600;
	text-decoration: none;
	padding: 0.5rem 1rem;
	background: rgba(37, 52, 112, 0.1);
	border-radius: 8px;
	transition: all 0.2s ease;

	i {
		transition: transform 0.2s;
	}

	&:hover {
		background: var(--intranet-accent-color-blue, #253470);
		color: white;
		transform: translateX(4px);

		i {
			transform: translateX(4px);
		}
	}
}

.notification-dismiss {
	position: absolute;
	top: 1rem;
	right: 1rem;
	width: 32px;
	height: 32px;
	background: var(--intranet-background-color, #e5e5e5);
	border: none;
	color: var(--intranet-soft-text-color, #5e5e5e);
	cursor: pointer;
	border-radius: 8px;
	display: flex;
	align-items: center;
	justify-content: center;
	transition: all 0.2s ease;
	opacity: 0;

	.notification-card:hover & {
		opacity: 1;
	}

	&:hover {
		background: $priority-urgent;
		color: white;
		transform: scale(1.1);
	}
}

// =============================================================================
// FOOTER CON LINK A INTRANET
// =============================================================================

.notifications-footer {
	margin-top: 1.5rem;
	padding-top: 1.25rem;
	border-top: 1px solid var(--intranet-border-color, #e5e5e5);
	text-align: center;
}

.view-all-link {
	display: inline-flex;
	align-items: center;
	gap: 0.5rem;
	color: var(--intranet-accent-color-blue, #253470);
	font-size: 0.95rem;
	font-weight: 600;
	text-decoration: none;
	padding: 0.75rem 1.5rem;
	background: rgba(37, 52, 112, 0.08);
	border-radius: 12px;
	transition: all 0.2s ease;

	i {
		font-size: 1.1rem;
	}

	&:hover {
		background: var(--intranet-accent-color-blue, #253470);
		color: white;
		transform: translateY(-2px);
		box-shadow: 0 4px 12px rgba(37, 52, 112, 0.3);
	}
}

// =============================================================================
// RESPONSIVE
// =============================================================================

@media (max-width: 768px) {
	.notification-bell-container {
		top: 16px;
		bottom: auto;
		right: 16px;
	}

	.notifications-section {
		position: fixed;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		width: 100%;
		max-width: 100%;
		max-height: 100%;
		border-radius: 0;
		padding: 1.25rem;
	}

	.notifications-header {
		flex-direction: column;
		align-items: flex-start;
		gap: 1.25rem;

		.header-actions {
			width: 100%;

			.action-btn {
				flex: 1;
				justify-content: center;
			}
		}
	}

	.bell-icon-animated {
		width: 48px;
		height: 48px;

		i {
			font-size: 1.35rem;
		}
	}

	.action-btn .btn-text {
		display: none;
	}

	.notification-card {
		padding: 1.25rem;
		padding-right: 2.75rem;

		&:hover {
			transform: none;
		}
	}

	.notification-icon {
		width: 48px;
		height: 48px;

		i {
			font-size: 1.2rem;
		}
	}

	.notification-dismiss {
		opacity: 1;
	}

	.priority-summary {
		flex-direction: column;
		gap: 0.4rem;
	}

	.notifications-list {
		gap: 1rem;
	}
}
